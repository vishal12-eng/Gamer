[build]
  # Fix TAR_BAD_ARCHIVE by cleaning cache before install
    command = "npm cache clean --force && npm ci && npm run build"
      publish = "dist"

      [build.environment]
        NODE_VERSION = "18"
          NPM_FLAGS = "--legacy-peer-deps"

          # SPA routing â€” IMPORTANT (prevents 404 on refresh)
          [[redirects]]
            from = "/*"
              to = "/index.html"
                status = 200

                # Cache optimization for performance + SEO
                [[headers]]
                  for = "/*"
                    [headers.values]
                        Cache-Control = "public, max-age=31536000, immutable"

                        # Cache rules for sitemap (Google recrawls often)
                        [[headers]]
                          for = "/sitemap.xml"
                            [headers.values]
                                Cache-Control = "public, max-age=600"

                                # Cache rules for robots.txt
                                [[headers]]
                                  for = "/robots.txt"
                                    [headers.values]
                                        Cache-Control = "public, max-age=3600"

                                        # Do not cache HTML (prevents stale metadata)
                                        [[headers]]
                                          for = "/*.html"
                                            [headers.values]
                                                Cache-Control = "no-cache"